# 성경 비교 뷰어 구현 전략 (AGENT)

## 목표
- `역본` 폴더와 `성경 직역 정보.csv`의 마지막 열(직역)을 이용해 성경 비교 뷰어를 구성한다.
- 두 역본 + 직역 열을 나란히 보여주고, 장 단위로 읽기 좋게 비교할 수 있게 한다.

## 데이터 전략
1) **정규화 인덱스 생성**
- `scripts/build_index.py`가 `data/index.json`을 생성한다.
- BHS 폴더의 영문 책 이름을 기준(bookId)으로 사용한다.
- NKRV 폴더의 번호-한글 책 이름으로 한글명과 순서를 매칭한다.
- KNT 폴더의 한글 책 이름은 NKRV 한글명과 매칭해 영문 bookId로 연결한다.
- 장 파일명은 숫자 정렬(예: 1, 2, …, 100)로 정렬한다.

2) **CSV 직역 매핑**
- CSV는 `;` 구분이며 마지막 열이 직역이다.
- CSV의 책 이름은 `Genesis`, `1_Samuel`, `Song_of_songs`처럼 언더스코어 표기를 사용한다.
- 뷰어에서는 `bookId`(예: `1 Samuel`)를 `1_Samuel`로 변환해 매칭한다.
- 특수 케이스: `Song of Solomon` → `Song_of_songs`.

3) **절 파싱 규칙**
- NKRV: `1. 내용` 형태를 파싱.
- BHS: `1 내용` 형태를 파싱 (히브리어 RTL 지원).
- KNT: `- 1: 내용` 형태를 파싱.
- 절 번호 기준으로 세 열(역본/역본/직역)을 정렬해 렌더링.

## UI/UX 전략
- 3열 비교(좌/우 역본 + 직역) 중심 레이아웃.
- 헤더/컨트롤은 상단 고정 느낌으로 배치.
- 절 번호를 모노스페이스로 강조해 시선 정렬.
- 히브리어(BHS)는 RTL 렌더링.
- 구분선/텍스처를 활용해 종이 같은 질감을 구현.

## 단계별 실행
1) 인덱스 생성
- `python3 scripts/build_index.py`

2) 로컬 서버 실행
- `python3 -m http.server 8000`
- 브라우저에서 `http://localhost:8000` 접속

## 협업(collab) 운영 계획
- **Coordinator**: 전체 일정/우선순위 관리, 인덱스/렌더링 통합 결정.
- **Data Agent**: CSV/MD 파싱 로직 및 책 매핑 개선, 성능 최적화.
- **UI Agent**: 레이아웃/타이포/색감 개선, 반응형 튜닝.
- **QA Agent**: 장 이동/역본 전환/직역 토글의 오류 점검.

## 유지보수 포인트
- 역본 폴더 구조 변경 시 `scripts/build_index.py` 갱신.
- CSV 컬럼 구조 변경 시 `app.js`의 CSV 파서 수정.
- 책 이름 매핑이 달라질 경우 `CSV_BOOK_OVERRIDES`에 추가.
